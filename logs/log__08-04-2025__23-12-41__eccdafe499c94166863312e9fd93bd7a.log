2025-04-08 23:12:41,434 - INFO:
Arquivo de log iniciado com sucesso!

2025-04-08 23:12:41,434 - INFO:
*********************************************************

---> Argumentos passados para o script:
Nome da VM para realizar backup -> ZABBIX OLT
Deve comprimir o backup em zip? -> False

2025-04-08 23:12:41,434 - INFO:
*********************************************************

Iniciando leitura das configurações...

2025-04-08 23:12:41,435 - INFO:
Configurações:
---> Configurações de logs:
Número máximo de logs -> 40
---> Configurações do script:
Deve enviar backup para o SFTP? -> True
Deve limpar backup local? -> True
Caminho local para o backup -> C:/VM_BACKUPS/
---> Configurações do servidor SFTP:
Endereço -> 160.238.226.1
Porta -> 2230
Usuário -> backups-ftp
Senha -> Conexaoba123
Caminho para salvar backup no SFTP -> /home/backups-ftp/BACKUPS/

2025-04-08 23:12:41,445 - INFO:
Configurações lidas com sucesso!

2025-04-08 23:12:41,445 - INFO:
*********************************************************

Iniciando limpeza dos logs antigos...

2025-04-08 23:12:41,448 - INFO:
Quantidade de logs excedida!

2025-04-08 23:12:41,448 - INFO:
Log removido: logs\log__08-04-2025__21-13-48__67774f73938b4135b2650e0fa5811e36.log

2025-04-08 23:12:41,449 - INFO:
Limpeza dos logs antigos finalizada com sucesso!

2025-04-08 23:12:41,449 - INFO:
*********************************************************

Inciando backup da VM: ZABBIX OLT

2025-04-08 23:12:41,449 - INFO:
Abrindo o script de backup no powershell...

2025-04-08 23:12:42,861 - CRITICAL:
Erro ao executar backup!

2025-04-08 23:12:42,862 - CRITICAL:
Retorno da execução do powershell:

##############################################################
InformaÃ§Ãµes capturadas:
VM que serÃ¡ realizado backup:  + ZABBIX OLT
Caminho raiz dos backups:  + C:/VM_BACKUPS/
Pasta para o backup da VM:  + ZABBIX OLT__08-04-2025__23-12-41__eccdafe499c94166863312e9fd93bd7a
--------------------------------------------------------------
Iniciando script de backup...
--------------------------------------------------------------
Elevando acesso do script para Administrador...
--------------------------------------------------------------
Verificando existÃªncia da pasta raiz dos backups...
Pasta nÃ£o existe, criando...
--------------------------------------------------------------
Verificando existÃªncia da pasta que guardarÃ¡ o backup...
Pasta nÃ£o existe, criando...
--------------------------------------------------------------
Iniciando backup...
Backup finalizado!
##############################################################

2025-04-08 23:12:42,862 - CRITICAL:
Erro:
Export-VM : O termo 'Export-VM' não é reconhecido como nome de cmdlet, função, arquivo de script ou programa operável. Verifique a grafia do nome ou, se um caminho tiver sido 
incluído, veja se o caminho está correto e tente novamente.
No C:\Users\conec\Development\BackupVMs\script_teste.ps1:77 caractere:1
+ Export-VM -Name $vm_to_backup -Path $path_for_backup
+ ~~~~~~~~~
+ CategoryInfo          : ObjectNotFound: (Export-VM:String) [], CommandNotFoundException
+ FullyQualifiedErrorId : CommandNotFoundException

2025-04-08 23:12:42,862 - CRITICAL:
*********************************************************

Programa finalizado com erro!

/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/*/

